# achievements are unlocked by setting a variable, either through on_actions, events in missions or manually, by pressing the re-check button in the sgui
# is_shown block shows whether the achievement is unlocked
# is_valid block shows whether it is possible to unlock it in this campaign at all
# a tooltip with conditions to unlock an achievement, like in vanilla, can be added with a second sgui, check pontic league for an example

# other files:
# common/on_actions/on_action_new_achievements.txt
# events/events_new_achievements.txt
# gui/shared/ach_font_icons.gui
# gui/achievements/jomini_achievements_window.gui
# localization/english/inv_achievements_l_english.yml



settled_matter = {
	scope = country

	is_shown = {
		has_variable = settled_matter
	}

	is_valid = {
		government = tribal_chiefdom
	}
}

ach_childs_play = {
	scope = country

	is_shown = {
		has_variable = ach_childs_play
	}

	is_valid = {
		always = yes
	}
}


#TODO currently doesn't work, as there's no event to form IDC (that I know of)
ach_indo_greek = {
	scope = country

	is_shown = {
		tag = IDC
	}

	is_valid = {
		trigger_if = {
			limit = {
				NOT = { tag = IDC }
			}
			OR = {
				tag = PAR
				tag = BAC
				tag = SEL
				tag = ARS
			}
		}
	}
}

ach_ark = {
	scope = country

	is_shown = {
		has_variable = ach_ark
	}

	is_valid = {
		OR = {
            tag = JUD
            tag = SMA
        }
	}
}

ach_kingdom_of_david = {
	scope = country

	is_shown = {
		has_variable = ach_kingdom_of_david
	}

	is_valid = {
		OR = {
            tag = JUD
            tag = SMA
        }
	}
}

ach_32_dynasty = {
	scope = country

	is_shown = {
		has_variable = ach_32_dynasty
	}

	is_valid = {
        tag = KSH
	}
}

# TODO scythian events were broken when I wrote this, waiting for a fix
# should be me_scythia_01_greek_stance.41
ach_greekaboos = {
	scope = country

	is_shown = {
		has_variable = ach_greekaboos
	}

	is_valid = {
        tag = SCY
	}
}

# TODO same
# should be me_scythia_01_greek_stance.112
ach_diamonds = {
	scope = country

	is_shown = {
		has_variable = ach_diamonds
	}

	is_valid = {
        tag = SCY
	}
}

# TODO verify that the mission tree is set up correctly, currently the tooltip for Tyras will be wrong
ach_pontic_league = {
	scope = country

	is_shown = {
		has_variable = ach_pontic_league
	}

	is_valid = {
		is_republic = yes
		OR = {
			primary_culture = bosporan
			primary_culture = greco_pontic
			primary_culture = thracian
		}
		NOT = {
			tag = BYZ
		}
		custom_tooltip = {
			text = black_sea_republic
			AND = {
				capital_scope = {
					OR = {
						is_in_region = bithynia_region
						is_in_region = colchis_region
						is_in_region = taurica_region
						is_in_area = olbia_area
						is_in_area = scythia_area
						is_in_area = moesia_orientalis_area
						is_in_area = haemimontus_area
						is_in_area = paphlagonia_inferior_area
						is_in_area = heracleotis_area
						is_in_area = machelonia_area
						is_in_area = europa_area
					}
				}
				any_owned_province = {
					is_port = yes
					OR = {
						is_in_region = bithynia_region
						is_in_region = colchis_region
						is_in_region = taurica_region
						is_in_area = olbia_area
						is_in_area = scythia_area
						is_in_area = moesia_orientalis_area
						is_in_area = haemimontus_area
						is_in_area = europa_area
						is_in_area = paphlagonia_inferior_area
						is_in_area = heracleotis_area
						is_in_area = machelonia_area
					}
				}
			}
		}
	}

	effect = {
		if = {
			limit = {
				tag = PTL
				owns_or_subject_owns_region = asia_region
				owns_or_subject_owns_region = cilicia_region
				owns_or_subject_owns_region = galatia_region
				owns_or_subject_owns_region = bithynia_region
				owns_or_subject_owns_region = cappadocia_region
				owns_or_subject_owns_region = cappadocia_pontica_region
			}
			set_variable = ach_pontic_league
		}
	}
}

ach_pontic_league_trigger = {
	scope = country

	is_shown = {
		NOT = { has_variable = ach_pontic_league }
	}

	is_valid = {
		custom_tooltip = {
			text = is_PTL
			tag = PTL
		}
		owns_or_subject_owns_region = asia_region
		owns_or_subject_owns_region = cilicia_region
		owns_or_subject_owns_region = galatia_region
		owns_or_subject_owns_region = bithynia_region
		owns_or_subject_owns_region = cappadocia_region
		owns_or_subject_owns_region = cappadocia_pontica_region
	}
}


ach_midas_touch = {
	scope = country

	is_shown = {
		has_variable = ach_midas_touch
	}

	is_valid = {
		always = yes
	}

	ai_is_valid = {
		always = no
	}

	effect = {
		if = {
			limit = {
				capital_scope = {
					state = {
						trade_good_surplus = {
							target = precious_metals
							value >= 10
						}
					}
				}
			}
			set_variable = ach_midas_touch
			# trigger_event = ach.4
		}
	}
}

ach_test = {
	scope = country

	is_shown = {
		has_variable = ach_test
	}

	is_valid = {
		always = yes
	}

	ai_is_valid = {
		always = no
	}

	effect = {
		if = {
			limit = {
				NOT = {
					any_province = {
						has_building = aqueduct_building #replace with fortress_ramparts_building to test quickly
					}
				}
			}
			set_variable = ach_test
			# trigger_event = ach.100
		}
	}
}
